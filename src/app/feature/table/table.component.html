<div class="container" style="width: 100%">
    {{ dataSource.tableHeader.displayColumns }}
    <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
        <!-- Header row first category group Search-->
        <ng-container matColumnDef="header-row-first-group">
            <th
                mat-header-cell
                *matHeaderCellDef
                [attr.position]="'relative'"
                [attr.colspan]="2"
                [attr.rowSpan]="2"
                [ngClass]="'w-200'"
            >
                <div class="search-section">
                    <div class="expand-icon-section expand-icon-category">
                        <mat-icon
                            class="expand-icon"
                            [ngClass]="{ rotated: this.dataSource.tableHeader.expandCategories }"
                            (click)="this.dataSource.expand('categories')"
                            >arrow_forward</mat-icon
                        >
                    </div>

                    <div class="expand-icon-section expand-icon-inputs">
                        <mat-icon
                            class="expand-icon"
                            [ngClass]="{ rotated: this.dataSource.tableHeader.expandInputs }"
                            (click)="this.dataSource.expand('inputs')"
                            >arrow_downward</mat-icon
                        >
                    </div>
                    <mat-form-field class="search-text-field" appearance="standard">
                        <mat-label>Search Inputs ...</mat-label>
                        <input matInput type="text" [(ngModel)]="searchValue" />
                        <div matSuffix style="display: flex">
                            <a matSuffix aria-label="Clear" (click)="filter()">
                                <mat-icon>search</mat-icon>
                            </a>
                            <a
                                *ngIf="searchValue"
                                matSuffix
                                mat-icon-button
                                aria-label="Clear"
                                (click)="searchValue = ''; filter()"
                            >
                                <mat-icon>close</mat-icon>
                            </a>
                        </div>
                    </mat-form-field>
                </div>
            </th>
        </ng-container>

        <!-- Category group headers -->
        <ng-container
            *ngFor="let column of dataSource.tableHeader.categoriesColumns"
            matColumnDef="{{ column.categoryIdentifier }}"
        >
            <th
                mat-header-cell
                *matHeaderCellDef
                [ngClass]="'header-product align-left'"
                [style.witdh]="getDynamicWidth(column)"
                [attr.colspan]="column.colspan"
                (click)="dataSource.toggleCategory(column.id, 'header')"
            >
                <span [ngClass]="'w-90pc pointer'">
                    {{ column.category }}
                </span>
            </th>
        </ng-container>

        <!-- Sticky Column Category/input-->
        <ng-container *ngFor="let column of dataSource.tableHeader.stickyColumns">
            <ng-container [matColumnDef]="column">
                <th mat-header-cell *matHeaderCellDef [ngClass]="'w-100'" style="display: none">
                    <span>{{ column }}</span>
                </th>

                <td mat-cell *matCellDef="let row" [ngClass]="row[column].className">
                    <ng-container [ngSwitch]="row[column].type">
                        <span
                            *ngSwitchCase="cellType.Category"
                            class="fs-14"
                            (click)="dataSource.toggleCategory(row['id'], 'column')"
                            >{{ row[column].text }}
                        </span>
                        <span *ngSwitchCase="cellType.Input">{{ row[column].text }}</span>
                    </ng-container>
                </td>
            </ng-container>
        </ng-container>

        <ng-container *ngFor="let column of dataSource.tableHeader.dynamicColumns">
            <ng-container [matColumnDef]="column">
                <th mat-header-cell *matHeaderCellDef [ngClass]="'w-100 align-center'">
                    <span>{{ column }}</span>
                </th>
                <td mat-cell *matCellDef="let row" [ngClass]="row[column].className">
                    <ng-container [ngSwitch]="row[column].type">
                        <!-- Empty Cell -->
                        <span *ngSwitchCase="cellType.EmptyCell"></span>
                        <!-- Cell -->
                        <ng-container *ngSwitchCase="cellType.Cell">
                            <div class="cell-container" [ngSwitch]="mode">
                                <!-- {{ row[column] | json }} -->
                                <mat-icon
                                    *ngSwitchCase="modes.ReadOnly"
                                    [ngClass]="{ 'in-active': !row[column].active }"
                                    >remove_red_eye</mat-icon
                                >

                                <mat-icon *ngSwitchCase="modes.Edit">insert_link</mat-icon>
                                <mat-icon *ngSwitchCase="modes.Validate">edit</mat-icon>
                            </div>
                        </ng-container>
                    </ng-container>
                </td>
            </ng-container>
        </ng-container>

        <tr
            mat-header-row
            *matHeaderRowDef="dataSource.tableHeader.displayCategoriesColumns"
            class="border-split-category-section"
        ></tr>
        <tr mat-header-row *matHeaderRowDef="dataSource.tableHeader.displayColumns" class="headers"></tr>
        <tr
            mat-row
            [ngClass]="getRowClassName(row)"
            *matRowDef="let row; columns: dataSource.tableHeader.displayColumns"
        ></tr>
    </table>
</div>
